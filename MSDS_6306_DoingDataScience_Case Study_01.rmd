---
title: "Case Study_01_BeerDataAnalysis"
authors: "Daniel Davieau, Lakeitra Webb, Emil Ramos"
date: "February 19, 2018"
output:
  html_document:
    keep_md: true
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy=TRUE)
```
Load Libraries
```{r, eval=TRUE}
rm(list=ls())
library(ggplot2)
library(readr)
library(repmis)
library(RCurl)
library(bitops)
library(tidyverse)
```
## Environment Information
```{r tidy=TRUE}
sessionInfo()
```
## Brewery Data Analysis

[Link to the Github Repository Associated with this Study](https://github.com/davxdan/MSDS_6306_DoingDataScience_Case-Study_01)

The purpose of this is to present findings from blah blah ....
The questions asked are listed below with data analysis methods and answers.  

### The Data Provided
Load Beers.csv
```{r, tidy=TRUE}
UrlAddress<- "https://raw.githubusercontent.com/davxdan/MSDS_6306_DoingDataScience_Case-Study_01/master/Input/RawDataFiles/Beers.csv"
DataURL<- getURL(UrlAddress)
RawBeerData<-read.table(textConnection(DataURL),fill = TRUE, sep=",", quote = "",header=TRUE)
#I was getting errors due to null values in some columns. So I added fill = TRUE which populates the null with NA.
```
Load Breweries.csv
```{r, tidy=TRUE}
UrlAddress<- "https://raw.githubusercontent.com/davxdan/MSDS_6306_DoingDataScience_Case-Study_01/master/Input/RawDataFiles/Breweries.csv"
DataURL<- getURL(UrlAddress)
RawBreweryData<-read.table(textConnection(DataURL),fill = TRUE, sep=",", quote = "",header=TRUE)
#again here I was getting errors due to null values. I added fill = TRUE which populates the null with NA.
```
###1. How many breweries are present in each state?
The record (110,"Woodstock Inn, Station & Brewery",North Woodstock, NH) was causing errors so I had to remove, and manually update it.

Identify the record:
```{r}
RawBreweryData[c(110, 111, 112),] #Identified erroneous records
```
```{r}
#Stage1BreweryData <- RawBreweryData[ which(RawBreweryData$Brew_ID!=' NH'), ] #this seemed to have worked
#newdata <- mydata[ which(mydata$gender=='F' & mydata$age > 65), ] #example from internet

StagedBreweryData<-spread(RawBreweryData, State) #convert long to wide. Transposed year
head(SpreadFert)#transposed
SpreadFert<-arrange(SpreadFert, country) #arranged by country alphabetically
GatheredFert<-gather(SpreadFert,Year,Fert,3:9)#Gather columns 3-9.Year now a factor rather than numeric.
head(GatheredFert)
GatheredFert<-rename(GatheredFert,year=Year,FertilizerConsumption=Fert) #Rename columns
GatheredFert<-GatheredFert[order(GatheredFert$country,GatheredFert$year),] #Sort data
FertOutliers<- subset(x = GatheredFert, FertilizerConsumption > 1000) #get only outliers
GatheredFertSub <- subset(x = GatheredFert, FertilizerConsumption <= 1000)
GatheredFertSub <- subset(x = GatheredFertSub, country != "Arab World")#subset the subset excluding bad records
GatheredFertSub<- subset(x = GatheredFertSub, !is.na(FertilizerConsumption)) #y <- x[!is.na(x)] #all non na values from x




#FixedRecords<-data.frame(rbind(c("110","Woodstock Inn Station & Brewery","North Woodstock"," NH" ),c("111","Renegade Brewing Company","Denver", " CO"))) #create records
#colnames(FixedRecords)<-colnames(RawBreweryData) #add names to the "FixedRecords" dataframe
```
Create a dataframe and call it Stage1BreweryData. I am assuming I will encounter additional issues the will require some tweaking. I want to avoid tampering with the original RawBreweryData dataframe loaded from the file.
```{r}
Stage1BreweryData<-data.frame(rbind(RawBreweryData[-c(110,111,112),],FixedRecords))
Stage1BreweryData<-data.frame(rbind(RawBreweryData[-c(110,111,112),]))
summary(Stage1BreweryData$State)
#myData[-c(2, 4, 6), ] 
```

```{r, tidy=TRUE}
CountBreweriesByState<-data.frame(Stage1BreweryData$State)
summary(CountBreweriesByState,maxsum=100)
```
###2. Merge beer data with the breweries data. Print the ﬁrst 6 observations and the last six observations to check the merged ﬁle.

###3. Report the number of NA’s in each column.

###4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

###5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

###6. Summary statistics for the ABV variable.

###7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot. You are welcome to use the ggplot2 library for graphs. Please ignore missing values in your analysis. Make your best judgment of a relationship and EXPLAIN your answer.









>Formatting Samples  

# Header 1   
## Header 2   
### THis is a header  
#### Header 4   
##### Header 5   
###### Header 6  

--  

---  

...  

$A = \pi*r^{2}$  

![](SampleImage.png)  

***  

> block quote  

* unordered list  

* item 2  

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
